let urlCacheArr=new Array;function getUrlCachePre(e){-1<e.indexOf("http")?getUrlCache(e):setIco(-1)}function getUrlCache(t){var e=urlCacheArr.find(e=>e.url===t);e?setIco(e.code):isOkUrl(t)}function isOkUrl(r){fetch("http://8.222.247.151:5000/detect",{method:"POST",headers:{"Content-Type":"application/json"},body:'{"url":"'+r+'"}'}).then(e=>e.text()).then(e=>{try{setIco((result=JSON.parse(e)).code);var t={url:r,code:result.code};urlCacheArr.push(t)}catch(e){}}).catch(e=>{console.error("Error:",e)})}function setIco(e){-1==e?chrome.action.setIcon({path:"shield_gray_16.png"}):0==e?chrome.action.setIcon({path:"shield_green_16.png"}):1==e&&chrome.action.setIcon({path:"shield_red_16.png"})}chrome.runtime.onMessage.addListener(function(e,t,r){"content"==e.from&&getUrlCachePre(e.url)}),chrome.tabs.onActivated.addListener(e=>{chrome.tabs.get(e.tabId,e=>{getUrlCachePre(e.url)})});